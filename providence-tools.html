<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7 at 2016-05-14 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20160514" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Providence &#x2013; Providence Tools</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.5.min.js"></script>

                      </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="https://github.com/morimekta/providence">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>Providence</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                  <li id="publishDate">Last Published: 2016-05-14
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 0.1.1
                      </li>
                      
              
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">Project Documentation</li>
                                                                                                                    
      <li>
  
                          <a href="project-info.html" title="Project Information">
          <span class="icon-chevron-right"></span>
        Project Information</a>
                  </li>
                              <li class="nav-header">Introduction</li>
                              
      <li>
  
                          <a href="index.html" title="Providence">
          <span class="none"></span>
        Providence</a>
            </li>
                
      <li class="active">
  
            <a href="#"><span class="none"></span>Providence Tools</a>
          </li>
                
      <li>
  
                          <a href="release.html" title="Release Process">
          <span class="none"></span>
        Release Process</a>
            </li>
                
      <li>
  
                          <a href="release-notes.html" title="Release Notes">
          <span class="none"></span>
        Release Notes</a>
            </li>
                
      <li>
  
                          <a href="downloads.html" title="Downloads">
          <span class="none"></span>
        Downloads</a>
            </li>
                              <li class="nav-header">Modules</li>
                              
      <li>
  
                          <a href="providence-core/index.html" title="Core">
          <span class="none"></span>
        Core</a>
            </li>
                
      <li>
  
                          <a href="providence-core-jackson/index.html" title="Core : Jackson">
          <span class="none"></span>
        Core : Jackson</a>
            </li>
                
      <li>
  
                          <a href="providence-core-client/index.html" title="Core : Client">
          <span class="none"></span>
        Core : Client</a>
            </li>
                
      <li>
  
                          <a href="providence-reflect/index.html" title="Tools : Reflect">
          <span class="none"></span>
        Tools : Reflect</a>
            </li>
                
      <li>
  
                          <a href="providence-generator/index.html" title="Tools : Generator">
          <span class="none"></span>
        Tools : Generator</a>
            </li>
                
      <li>
  
                          <a href="providence-maven-plugin/index.html" title="Tools : Maven Plugin">
          <span class="none"></span>
        Tools : Maven Plugin</a>
            </li>
                
      <li>
  
                          <a href="providence-thrift/index.html" title="Utils: Thrift Bridge">
          <span class="none"></span>
        Utils: Thrift Bridge</a>
            </li>
                
      <li>
  
                          <a href="providence-testing/index.html" title="Utils: Testing">
          <span class="none"></span>
        Utils: Testing</a>
            </li>
                              <li class="nav-header">Docs</li>
                              
      <li>
  
                          <a href="generated-java.html" title="Generated Java Code">
          <span class="none"></span>
        Generated Java Code</a>
            </li>
                
      <li>
  
                          <a href="serializer-binary.html" title="Serializer : Binary">
          <span class="none"></span>
        Serializer : Binary</a>
            </li>
                
      <li>
  
                          <a href="serializer-fast-binary.html" title="Serializer : Fast Binary">
          <span class="none"></span>
        Serializer : Fast Binary</a>
            </li>
                
      <li>
  
                          <a href="serializer-json.html" title="Serializer : JSON">
          <span class="none"></span>
        Serializer : JSON</a>
            </li>
            </ul>
              
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <h1>Providence Tools</h1>
<p>There are made a set of command line tools for providence. You can get them from the <a href="downloads.html">downloads</a> section. They&#x2019;re in the same <tt>providence</tt> package.</p>
<div class="section">
<h2><a name="Code_Generator"></a>Code Generator</h2>
<p>The compiler (or code generator) <tt>pvdc</tt>.</p>
<p><b>TBD:</b> Write about the compiler.</p></div>
<div class="section">
<h2><a name="Data_Converter"></a>Data Converter</h2>
<p>The data converter <tt>pvd</tt> is a small program that can read a thrift IDL, and a binary (or non-binary) serialized data file that follows that IDL structure, and the output the result in some form of readable (or other binary) data format. As for example:</p>
<p>Given the thrift IDL in <tt>thrift/test.thrift</tt>:</p>

<div class="source">
<div class="source"><pre class="prettyprint">struct MyData {
  1: string text
  2: i32 sequence
  3: list&lt;string&gt; tags
}
</pre></div></div>
<p>And a binary file with a set of data entries in test.MyData format. We could do something like this:</p>

<div class="source">
<div class="source"><pre class="prettyprint">cat test.data | pvd -I thrift/ test.MyData
</pre></div></div>
<p>And should make the output:</p>

<div class="source">
<div class="source"><pre class="prettyprint">{
  &quot;text&quot;: &quot;not a test at all&quot;,
  &quot;sequence&quot;: 144
}
{
  &quot;text&quot;: &quot;test 2&quot;,
  &quot;tags&quot;: [
    &quot;first&quot;,
    &quot;second&quot;
  ]
}
</pre></div></div>
<p>Input and output can be specified to point directly to files (no shell piping needed), and the input and output serialization format can be specified too.</p>

<div class="source">
<div class="source"><pre class="prettyprint">pvd -i fast_binary,file:test.data -o pretty -I thrift/ test.MyData
</pre></div></div>
<p>Which should read the data file serialized with the FastBinarySerializer format and print it out with the simple &#x201c;pretty printer&#x201d; format.</p></div>
<div class="section">
<h2><a name="RPC_Tool"></a>RPC Tool</h2>
<p>The providence RPC tool <tt>pvdrpc</tt> is a program designed to test out thrift and providence RPC service calls based on the same ad-hoc type parsing as <tt>pvd</tt> uses. It supports HTTP servlet wrapped RPC (e.g. using the <tt>TServlet</tt>), the <tt>TSimpleServer</tt> direct socket RPC, and the <tt>TNonblockingServer</tt> that also wraps the calls in sized frame buffers.</p>
<p>The providence RPC tool connects to a remote service, and sends a service call (which can be parsed from files the same way as the data files above), and sent as an actual remote procedure call:</p>

<div class="source">
<div class="source"><pre class="prettyprint">[
  &quot;test&quot;,
  1,
  0,
  {
    &quot;request&quot;: {
      &quot;test&quot;: &quot;my test&quot;,
      &quot;sequence&quot;: 44,
      &quot;tags&quot;: [
        &quot;first&quot;,
        &quot;second&quot;
      ]
    }
  }
]
</pre></div></div>
<p>Which is the RPC call data, and the shell command:</p>

<div class="source">
<div class="source"><pre class="prettyprint">cat req.json | pvdrpc -I thrift/ test.MyService http://localhost:8080/test_service
</pre></div></div>
<p>Which would then:</p>

<ul>
  
<li>Parse the thrift IDL in thrift/ directory, pick out the test.MyService service  from there.</li>
  
<li>Read the req.json request call (which needs to follow the desired input format&#x2019;s  service call syntax), and use that to send the actual RPC call to the remote  service at <tt>http://localhost:8000/test_service</tt>.</li>
  
<li>Parse the response (in whatever format returned) and print out to standard out  so the user can read it. E.g.:</li>
</ul>

<div class="source">
<div class="source"><pre class="prettyprint">[
  &quot;test&quot;,
  2,
  0,
  {
    &quot;success&quot;: {
      &quot;test&quot;: &quot;my test&quot;,
      &quot;sequence&quot;: 44,
      &quot;tags&quot;: [
        &quot;first&quot;,
        &quot;second&quot;
      ]
    }
  }
]
</pre></div></div>
<p>Or if a non-200 HTTP response is received will print out the error message received.</p>
<p>Note that in the two json structures shown there is the serialized service call data in addition to the request and response wrappers around the actual request and response objects. The format here is:</p>
<p><tt>[&quot;${method}&quot;, ${type}, ${sequence}, ${wrapper}]</tt></p>
<p>Where the type can be 1: request, 2: response, 3: exception, and 4: oneway. The sequence number is something the transport layer (http, client etc) can use to match response messages to the correct caller, and the wrapper is either the <tt>request params wrapper</tt> the <tt>response wrapper</tt>, or the <tt>application exception</tt>. Oneway calls are calls the does not want a response.</p>

<ul>
  
<li>
<p>The <tt>request params wrapper</tt> message is a generated thrift struct that  contains all the method params as field values. E.g. the method  <tt>ResponseStruct my_test(1: i32 num, 2: string text)</tt> would become  equivalent to the struct:</p>
  
<div class="source">
<div class="source"><pre class="prettyprint">struct my_test___params {
  1: i32 num
  2: string text
}
</pre></div></div></li>
  
<li>
<p>The <tt>response wrapper</tt> is a wrapper of the return type (put in a field  named <tt>success</tt>), and of each possible exception put in a union. In order  to make it impossible to conflict with field IDs, the success field gets  the index <tt>0</tt>, which is not allowed to declare. E.g.:</p>
  
<div class="source">
<div class="source"><pre class="prettyprint">union my_test___response {
  0: ResponseStruct success
  1: MyException ex1
}
</pre></div></div></li>
  
<li>
<p>The <tt>application exception</tt> is a generic providence exception message that can  be passed with call type 3 (exception), usually to tell a client about a  problem that was caused outside of the actual service call, e.g. serialization  problems, bad method call, etc. It is equivalent to:</p>
  
<div class="source">
<div class="source"><pre class="prettyprint">exception ApplicationException {
    1: string message
    2: i32 type
}
</pre></div></div></li>
</ul>
<div class="section">
<div class="section">
<h4><a name="Supported_Protocols"></a>Supported Protocols</h4>

<ul>
  
<li><tt>http://</tt> and <tt>https://</tt>: Connects to a thrift <tt>TServlet</tt> or similar.</li>
  
<li><tt>thrift://</tt>: Connects to a <tt>TSimpleServer</tt> type thrift server.</li>
  
<li><tt>thrift+nonblocking://</tt>: Connects to a <tt>TNonblockingServer</tt> type thrift server,  or a similar thrift server that wraps messages in <tt>TFramedTransport</tt>.</li>
</ul></div></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                          <script>
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-3087264-4', 'auto');
                ga('send', 'pageview');
            </script>
                </div>

        
                </div>
    </footer>
        </body>
</html>
